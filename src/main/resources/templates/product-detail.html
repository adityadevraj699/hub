<html lang="en" th:replace="base :: layout(~{::section})">
<section class="py-5" style="background: #f4f6f8;">
  <div class="container mt-5">

    <div class="row g-5">
      <!-- Product Image -->
      <div class="col-md-5 text-center">
        <div class="product-image-container position-relative">
          <img th:src="@{${product.image}}" class="img-fluid rounded shadow-sm product-detail-image" alt="Product" />
        </div>
      </div>

      <!-- Product Info -->
      <div class="col-md-7">
        <h2 class="fw-bold mb-3" th:text="${product.name}"></h2>
        <p class="mb-3 text-muted" th:text="${product.description}"></p>
        <h4 class="text-success mb-2">$<span th:text="${product.price}"></span></h4>
        <p class="mb-4 fw-semibold" th:text="${product.quantity > 0 ? 'In Stock: ' + product.quantity : 'Out of Stock'}"></p>

        <!-- Wishlist -->
        <span th:if="${currentUser != null}">
          <a th:href="@{/wishlist/toggle/{id}(id=${product.id})}" class="btn btn-outline-danger me-2 mb-2">
            <i class="fa" th:classappend="${product.isInWishlist} ? 'fa-heart' : 'fa-heart-o'"></i> Wishlist
          </a>
        </span>
        <span th:if="${currentUser == null}">
          <a th:href="@{/login}" class="btn btn-outline-danger me-2 mb-2">
            <i class="fa" th:classappend="${product.isInWishlist} ? 'fa-heart' : 'fa-heart-o'"></i> Wishlist
          </a>
        </span>

        <!-- Cart & Buy Now -->
        <div class="d-flex flex-wrap gap-2">
          <form th:action="@{/cart/add/{id}(id=${product.id})}" method="post" class="d-inline">
            <input type="hidden" name="quantity" value="1" />
            <button type="submit" class="btn btn-gradient-success">Add to Cart</button>
          </form>

          <form th:action="@{/checkout/single/{id}(id=${product.id})}" method="get" class="d-inline">
            <input type="hidden" name="quantity" value="1" />
            <button type="submit" class="btn btn-gradient-warning">Buy Now</button>
          </form>
        </div>
      </div>
    </div>

  </div>

  <!-- ===== Bootstrap + FontAwesome ===== -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" />

  <style>
    /* ---------- Product Image ---------- */
    .product-detail-image {
      max-height: 450px;
      object-fit: cover;
      width: 100%;
      transition: transform 0.4s ease, box-shadow 0.4s ease;
      border-radius: 16px;
    }

    .product-detail-image:hover {
      transform: scale(1.05);
      box-shadow: 0 15px 30px rgba(0,0,0,0.2);
    }

    /* ---------- Buttons ---------- */
    .btn-gradient-success {
      background: linear-gradient(90deg, #28a745, #20c997);
      color: #fff;
      border: none;
      border-radius: 30px;
      padding: 0.6rem 1.8rem;
      transition: all 0.3s ease;
    }

    .btn-gradient-success:hover {
      transform: scale(1.05);
      box-shadow: 0 0 15px rgba(40,167,69,0.6);
    }

    .btn-gradient-warning {
      background: linear-gradient(90deg, #ffc107, #ff922b);
      color: #fff;
      border: none;
      border-radius: 30px;
      padding: 0.6rem 1.8rem;
      transition: all 0.3s ease;
    }

    .btn-gradient-warning:hover {
      transform: scale(1.05);
      box-shadow: 0 0 15px rgba(255,193,7,0.6);
    }

    .btn-outline-danger {
      border-radius: 30px;
      transition: all 0.3s ease;
    }

    .btn-outline-danger:hover {
      background-color: #dc3545;
      color: #fff;
      transform: scale(1.05);
    }

    /* ---------- Responsive ---------- */
    @media (max-width: 768px) {
      .product-detail-image {
        max-height: 300px;
      }
      .d-flex.flex-wrap.gap-2 {
        flex-direction: column;
      }
    }
  </style>
</section>
</html>
